---
title: "Socioeconomic Determinants of Hate Crimes in the United States"
subtitle: "A Bayesian Hierarchical Analysis"
author: 
  - Yuxuan Wei
thanks: "Code and data are available at: [https://github.com/wyx827/Hate_Crimes_Socioeconomic_Analysis]."
date: today
date-format: long
abstract: "This study provides the relationship between socioeconomic factors and hate crimes across U.S. states using a Bayesian hierarchical framework. We analyze a dataset capturing hate crime incidence alongside state-level socioeconomic indicators such as median income, unemployment rates, and income inequality. Results reveal that higher income inequality and unemployment rates are associated with elevated hate crime rates, while higher median income is inversely related. These findings emphasize the need for targeted socioeconomic interventions to mitigate hate crime prevalence."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

# Library the required packages
library(dplyr)         
library(ggplot2)       
library(rstanarm)      
library(tidyr)        
library(arrow)         
library(readr)          

# Library the cleaned data
analysis_data <- read_csv(here::here("data/02-analysis_data/cleaned_hate_crimes.csv"))
```


# Introduction

Hate crimes remain a significant social issue in the United States, threatening community safety and equality. These crimes disproportionately affect marginalized groups and undermine social trust. Existing research identifies socioeconomic factors—such as income inequality, unemployment, and education—as potential contributors to hate crime prevalence. However, most studies overlook state-specific variations in these relationships, limiting the understanding of how regional disparities influence hate crime patterns. This paper uses data sourced from @hatecrimesdata, which provides detailed state-level hate crime statistics alongside socioeconomic indicators, to explore these relationships rigorously.

This paper investigates the effect of state-level socioeconomic factors on hate crime rates. The estimand is the average marginal effect of variables, including income inequality, unemployment, and education levels, on hate crimes per 100,000 population. A Bayesian hierarchical model is employed to account for regional heterogeneity, allowing for more precise estimation of these effects.

The results demonstrate that states with higher income inequality and unemployment rates report more hate crimes, while higher median income and education levels are associated with reduced hate crime prevalence. These findings emphasize the socioeconomic disparities that contribute to hate crime patterns, suggesting the importance of addressing inequality and unemployment at the state level.

Understanding the socioeconomic determinants of hate crimes is essential for informing policies aimed at reducing their prevalence. This analysis provides evidence for the role of structural inequality and economic conditions in shaping hate crime patterns, offering a foundation for targeted policy interventions to foster safer and more equitable communities.

The remainder of this paper is structured as follows. @sec-data describes the dataset, variables, and preprocessing steps. Section 3 outlines the methodological framework, including the Bayesian hierarchical model. Section 4 presents the results, accompanied by tables and visualizations. Section 5 discusses the implications, limitations, and potential future directions of the analysis. Section 6 concludes with a summary of the key findings and recommendations.


# Data {#sec-data}

## Overview

We use the statistical programming language R [@citeR], which provides a robust and flexible environment for statistical analysis and modeling. The data manipulation and cleaning tasks in this study are performed using [@tidyverse]. To visualize the variables and their relationships, we employ ggplot2 [@ggplot2], known for its elegant and versatile approach to graphical representation.

The Bayesian hierarchical model is implemented using the rstanarm package [@rstanarm], which facilitates applied Bayesian regression modeling in R. Additionally, the arrow package [@arrow] is used to handle efficient reading and writing of Parquet files, ensuring smooth data processing workflows.

Our dataset is sourced from FiveThirtyEight [@hatecrimesdata], which integrates hate crime statistics with state-level socioeconomic variables, providing a comprehensive basis for the analysis.



## Measurement
	
Some paragraphs about how we go from a phenomena in the world to an entry in the dataset.

## Outcome variables

Add graphs, tables and text. Use sub-sub-headings for each outcome variable or update the subheading to be singular.



Some of our data is of penguins (@fig-bills), from @palmerpenguins.

```{r}
#| label: fig-bills
#| fig-cap: Bills of penguins
#| echo: false

ggplot(penguins, aes(x = island, fill = species)) +
  geom_bar(alpha = 0.8) +
  scale_fill_manual(values = c("darkorange","purple","cyan4"),
                    guide = "none") +
  theme_minimal() +
  facet_wrap(~species, ncol = 1) +
  coord_flip()
```

Talk more about it.

And also planes (@fig-planes). (You can change the height and width, but don't worry about doing that until you have finished every other aspect of the paper - Quarto will try to make it look nice and the defaults usually work well once you have enough text.)

```{r}
#| label: fig-planes
#| fig-cap: Relationship between wing length and width
#| echo: false
#| warning: false
#| message: false

analysis_data <- read_csv(here::here("data/02-analysis_data/analysis_data.csv"))

analysis_data |> 
  ggplot(aes(x = width, y = length)) +
  geom_point(alpha = 0.8) +
  theme_minimal() +
  labs(x = "Wing width (mm)",
       y = "Wing length (mm)")
```

Talk way more about it. 

## Predictor variables

Add graphs, tables and text.

Use sub-sub-headings for each outcome variable and feel free to combine a few into one if they go together naturally.








# Model

The goal of our modelling strategy is twofold. Firstly,...

Here we briefly describe the Bayesian analysis model used to investigate... Background details and diagnostics are included in [Appendix -@sec-model-details].

## Model set-up

Define $y_i$ as the number of seconds that the plane remained aloft. Then $\beta_i$ is the wing width and $\gamma_i$ is the wing length, both measured in millimeters.  

\begin{align} 
y_i|\mu_i, \sigma &\sim \mbox{Normal}(\mu_i, \sigma) \\
\mu_i &= \alpha + \beta_i + \gamma_i\\
\alpha &\sim \mbox{Normal}(0, 2.5) \\
\beta &\sim \mbox{Normal}(0, 2.5) \\
\gamma &\sim \mbox{Normal}(0, 2.5) \\
\sigma &\sim \mbox{Exponential}(1)
\end{align}

We run the model in R [@citeR] using the `rstanarm` package of @rstanarm. We use the default priors from `rstanarm`.


### Model justification

We expect a positive relationship between the size of the wings and time spent aloft. In particular...

We can use maths by including latex between dollar signs, for instance $\theta$.


# Results

Our results are summarized in @tbl-modelresults.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false

library(rstanarm)

first_model <-
  readRDS(file = here::here("models/first_model.rds"))
```

```{r}
#| echo: false
#| eval: true
#| label: tbl-modelresults
#| tbl-cap: "Explanatory models of flight time based on wing width and wing length"
#| warning: false

modelsummary::modelsummary(
  list(
    "First model" = first_model
  ),
  statistic = "mad",
  fmt = 2
)
```




# Discussion

## First discussion point {#sec-first-point}

## Second discussion point

## Third discussion point

## Weaknesses and next steps

\newpage

\appendix

# Appendix {-}

# Additional data details

# Model details {#sec-model-details}

## Posterior predictive check

In @fig-ppcheckandposteriorvsprior-1 we implement a posterior predictive check. This shows...

In @fig-ppcheckandposteriorvsprior-2 we compare the posterior with the prior. This shows... 

```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false
#| label: fig-ppcheckandposteriorvsprior
#| layout-ncol: 2
#| fig-cap: "Examining how the model fits, and is affected by, the data"
#| fig-subcap: ["Posterior prediction check", "Comparing the posterior with the prior"]

pp_check(first_model) +
  theme_classic() +
  theme(legend.position = "bottom")

posterior_vs_prior(first_model) +
  theme_minimal() +
  scale_color_brewer(palette = "Set1") +
  theme(legend.position = "bottom") +
  coord_flip()
```

## Diagnostics

@fig-stanareyouokay-1 is a trace plot. It shows... This suggests...

@fig-stanareyouokay-2 is a Rhat plot. It shows... This suggests...

```{r}
#| echo: false
#| eval: true
#| message: false
#| warning: false
#| label: fig-
#| fig-cap: "Checking the convergence of the MCMC algorithm"
#| fig-subcap: ["Trace plot", "Rhat plot"]
#| layout-ncol: 2

```



\newpage


# References
